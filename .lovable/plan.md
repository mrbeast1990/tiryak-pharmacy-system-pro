

# خطة تحسين نماذج إدخال البيانات

## نظرة عامة
سيتم تنفيذ ثلاثة تحسينات رئيسية:
1. عرض الاسم العلمي تحت اسم الدواء في بطاقة النواقص
2. إضافة اقتراحات للاسم العلمي (مثل اسم الدواء)
3. تحسين نموذج المصاريف ليكون مطابقاً لنموذج السدادات

---

## 1. عرض الاسم العلمي في بطاقة الدواء

### التغيير في `SwipeableMedicineCard.tsx`:

```text
┌──────────────────────────────────────────────────────────────┐
│ ▌ Paracetamol 500mg                         [عادي]         │
│ ▌ Acetaminophen                  ← الاسم العلمي بخط باهت    │
│ ▌ 01/02/2026 • محمد              [حذف] [تم التوفير]         │
└──────────────────────────────────────────────────────────────┘
```

**المواصفات:**
- يظهر تحت اسم الدواء مباشرة
- خط صغير (`text-xs`) ولون باهت (`text-muted-foreground/60`)
- يظهر فقط إذا كان الاسم العلمي موجوداً

---

## 2. اقتراحات الاسم العلمي

### تحديث `suggestionsStore.ts`:

إضافة دالة جديدة لاقتراحات الأسماء العلمية:

```typescript
getScientificNameSuggestions: (medicines: any[], query: string) => string[]
```

**المنطق:**
- تبحث في حقل `scientific_name` من الأدوية الموجودة
- تُظهر الاقتراحات عند كتابة حرفين أو أكثر
- تستبعد الاقتراحات المحذوفة

### تحديث `AddMedicineDialog.tsx`:

- إضافة state للاقتراحات: `showScientificSuggestions`
- عرض dropdown للاقتراحات مثل اسم الدواء
- إمكانية حذف الاقتراحات بنفس الطريقة

---

## 3. تحسين نموذج المصاريف

### التصميم الجديد لـ `ExpenseForm.tsx`:

```text
┌─────────────────────────────────────────────────────────────┐
│  ┌───────┐                                                  │
│  │ ➕ 📋 │  إضافة مصروف جديد                    [▲ / ▼]    │
│  └───────┘                                                  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  💰 القيمة (د.ل)                                            │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                      0.00                           │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  📝 البيان                                                  │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  مثال: إيجار، كهرباء، صيانة...                      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  📅 التاريخ                                                 │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  yyyy-MM-dd                                         │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  📎 ملاحظات (اختياري)                                       │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  أي تفاصيل إضافية...                                │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │             ➕ إضافة المصروف                         │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**التغييرات:**
- تحويل إلى `Collapsible` مثل نموذج السدادات
- إضافة أيقونات لكل حقل
- إضافة حقل ملاحظات اختياري
- استخدام `Input type="date"` بدلاً من Calendar Popover للتبسيط
- تحسين التنسيق والأيقونات

---

## 4. ملخص الملفات المتأثرة

| الملف | نوع التعديل |
|-------|-------------|
| `src/components/shortage/SwipeableMedicineCard.tsx` | عرض الاسم العلمي |
| `src/components/shortage/AddMedicineDialog.tsx` | اقتراحات الاسم العلمي |
| `src/store/suggestionsStore.ts` | دالة اقتراحات جديدة |
| `src/components/expenses/ExpenseForm.tsx` | إعادة تصميم كاملة |

---

## 5. التفاصيل التقنية

### أ. عرض الاسم العلمي في البطاقة:
```tsx
{medicine.scientific_name && (
  <p className="text-xs text-muted-foreground/60 italic truncate">
    {medicine.scientific_name}
  </p>
)}
```

### ب. اقتراحات الاسم العلمي:
```typescript
getScientificNameSuggestions: (medicines: any[], query: string) => {
  if (query.length < 2) return [];
  const lowerQuery = query.toLowerCase();
  
  return medicines
    .filter(m => m.scientific_name?.toLowerCase().includes(lowerQuery))
    .map(m => m.scientific_name)
    .filter((name, index, self) => name && self.indexOf(name) === index)
    .slice(0, 8);
}
```

### ج. نموذج المصاريف:
- استخدام `Collapsible` من Radix UI
- نفس هيكل `PaymentForm.tsx`
- إضافة `Textarea` للملاحظات
- تحسين UX مع أيقونات واضحة

